import { useState } from 'react';
import { AboutSection } from './menu/AboutSection';
import { HowItWorksSection } from './menu/HowItWorksSection';
import { TermsSection } from './menu/TermsSection';
import { PrivacySection } from './menu/PrivacySection';
import './MenuContent.css';

export type MenuSection = 'about' | 'how-it-works' | 'terms' | 'privacy';

interface MenuContentProps {
  socialSettings: {
    pumpFunUrl: string;
    pumpFunEnabled: boolean;
    xUsername: string;
    xEnabled: boolean;
    instagramUsername: string;
    instagramEnabled: boolean;
    tiktokUsername: string;
    tiktokEnabled: boolean;
  };
}

export function MenuContent({ socialSettings }: MenuContentProps) {
  // Accordion expanded state; About expanded by default
  const [expanded, setExpanded] = useState<Record<MenuSection, boolean>>({
    about: true,
    'how-it-works': false,
    terms: false,
    privacy: false,
  });

  const toggle = (key: MenuSection) => {
    setExpanded((prev) => {
      // If clicking the same item, toggle it; otherwise close all and open the clicked one
      if (prev[key]) {
        // Close if already open
        return { ...prev, [key]: false };
      } else {
        // Close all others and open the clicked one
        return {
          about: false,
          'how-it-works': false,
          terms: false,
          privacy: false,
          [key]: true,
        };
      }
    });
  };

  // Build social links array
  const socialLinks = [];
  if (socialSettings.pumpFunEnabled && socialSettings.pumpFunUrl) {
    socialLinks.push({
      name: 'Pump.fun',
      url: socialSettings.pumpFunUrl,
      icon: 'üöÄ',
    });
  }
  if (socialSettings.xEnabled && socialSettings.xUsername) {
    socialLinks.push({
      name: 'X',
      url: `https://x.com/${socialSettings.xUsername}`,
      icon: 'ùïè',
    });
  }
  if (socialSettings.instagramEnabled && socialSettings.instagramUsername) {
    socialLinks.push({
      name: 'Instagram',
      url: `https://instagram.com/${socialSettings.instagramUsername}`,
      icon: 'üì∑',
    });
  }
  if (socialSettings.tiktokEnabled && socialSettings.tiktokUsername) {
    socialLinks.push({
      name: 'TikTok',
      url: `https://tiktok.com/@${socialSettings.tiktokUsername}`,
      icon: 'üéµ',
    });
  }

  return (
    <div className="menu-overlay-content">
      <div className="menu-main-menu">
        {/* Main accordion nav - only About and How It Works */}
        {!expanded['terms'] && !expanded['privacy'] && (
          <nav className="menu-nav">
            <div className="menu-accordion">
              <div className={`menu-accordion-item ${expanded['about'] ? 'open' : ''}`}>
                <button className="menu-item" onClick={() => toggle('about')}>About Us</button>
                {expanded['about'] && (
                  <div className="menu-accordion-content">
                    <AboutSection />
                  </div>
                )}
              </div>

              <div className={`menu-accordion-item ${expanded['how-it-works'] ? 'open' : ''}`}>
                <button className="menu-item" onClick={() => toggle('how-it-works')}>How It Works</button>
                {expanded['how-it-works'] && (
                  <div className="menu-accordion-content">
                    <HowItWorksSection />
                  </div>
                )}
              </div>
            </div>
          </nav>
        )}

        {/* Legal nav - Terms and Privacy get their own nav area */}
        {(expanded['terms'] || expanded['privacy']) && (
          <nav className="menu-nav-legal">
            <div className="menu-accordion">
              {expanded['terms'] && (
                <div className="menu-accordion-item open">
                  <button className="menu-item" onClick={() => toggle('terms')}>Terms of Use</button>
                  <div className="menu-accordion-content">
                    <TermsSection />
                  </div>
                </div>
              )}

              {expanded['privacy'] && (
                <div className="menu-accordion-item open">
                  <button className="menu-item" onClick={() => toggle('privacy')}>Privacy Policy</button>
                  <div className="menu-accordion-content">
                    <PrivacySection />
                  </div>
                </div>
              )}
            </div>
          </nav>
        )}

        {/* Footer with socials, terms, and privacy - always visible at the bottom */}
        <div className="menu-social-footer">
          {socialLinks.length > 0 && (
            <div className="menu-social-links">
              {socialLinks.map((link, index) => (
                <a
                  key={index}
                  href={link.url}
                  target="_blank"
                  rel="noopener noreferrer"
                  className="menu-social-link"
                  title={link.name}
                >
                  {link.name === 'Pump.fun' && (
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 179.419 186.169" fill="currentColor">
                      <g transform="translate(-1.604 -1.364)">
                        <path d="M 56.40446090698242 184.0314483642578 C 56.40403747558594 184.0314483642578 56.40410995483398 184.0314483642578 56.4036865234375 184.0314483642578 C 50.11719131469727 184.0314025878906 43.96616744995117 182.8994445800781 38.12093734741211 180.6668548583984 C 37.29201507568359 180.3462982177734 36.57952117919922 180.0536193847656 35.94308090209961 179.7722320556641 L 35.9332389831543 179.7678985595703 L 35.92337036132812 179.7636108398438 C 35.20315933227539 179.4504547119141 34.4768180847168 179.1140747070312 33.76450347900391 178.7637939453125 L 33.76918792724609 178.76611328125 C 31.26594924926758 177.5304718017578 28.83326530456543 176.0660552978516 26.53873825073242 174.4134979248047 L 26.53315925598145 174.4094696044922 L 26.52758026123047 174.4055023193359 C 25.92758178710938 173.9769439697266 25.28613471984863 173.4918365478516 24.56655502319336 172.9225006103516 L 24.57263374328613 172.9273376464844 C 23.61192321777344 172.1637115478516 22.65734481811523 171.3466796875 21.73547554016113 170.4989471435547 C 14.23752880096436 163.6062164306641 8.999554634094238 154.7454681396484 6.587449550628662 144.8743133544922 C 4.612817764282227 136.7993621826172 4.616081237792969 128.2715606689453 6.596712589263916 120.2122650146484 C 7.603528499603271 116.1155242919922 9.114054679870605 112.153450012207 11.08634471893311 108.4361038208008 C 13.11908149719238 104.6048965454102 15.64837074279785 101.0242385864258 18.60397529602051 97.7935791015625 L 50.83971405029297 62.56613159179688 L 56.10345077514648 56.81142044067383 L 88.383056640625 21.53034210205078 C 93.32984161376953 16.1225528717041 99.21923828125 11.92326354980469 105.8877944946289 9.048816680908203 C 109.0876083374023 7.669553279876709 112.4460830688477 6.61436939239502 115.8699722290039 5.912553310394287 C 119.2657928466797 5.216474533081055 122.7470016479492 4.863527297973633 126.2168426513672 4.863527297973633 C 131.9675750732422 4.863527297973633 137.6272430419922 5.81639575958252 143.0386047363281 7.695632457733154 C 149.6696014404297 9.994553565979004 155.6743774414062 13.59250068664551 160.8878479003906 18.39015960693359 C 166.2853240966797 23.35373687744141 170.4762725830078 29.25955390930176 173.3451080322266 35.94434356689453 C 174.7223205566406 39.15336990356445 175.7759552001953 42.52136993408203 176.4767456054688 45.95473861694336 C 177.1719818115234 49.36076354980469 177.5244750976562 52.85250091552734 177.5244750976562 56.33302688598633 C 177.5244750976562 69.23747253417969 172.7289733886719 81.58323669433594 164.0213165283203 91.09613037109375 L 135.6113128662109 122.1465301513672 L 131.7400054931641 126.3783416748047 L 129.1106872558594 129.2545471191406 L 126.4773941040039 132.1332702636719 L 121.7163467407227 137.3346862792969 L 94.24158477783203 167.3603210449219 C 92.05455780029297 169.7507934570312 89.65313720703125 171.9289245605469 87.10379028320312 173.8344268798828 L 87.09560394287109 173.8405609130859 L 87.08742523193359 173.8467407226562 C 86.3922119140625 174.3727569580078 85.65771484375 174.8944549560547 84.90439605712891 175.3972930908203 L 84.90160369873047 175.3991546630859 L 84.89881896972656 175.4010009765625 C 83.78202819824219 176.1495513916016 82.63529205322266 176.8530578613281 81.49042510986328 177.4919738769531 L 81.4864501953125 177.4941864013672 L 81.48250579833984 177.4963989257812 C 80.31829071044922 178.1500854492188 79.12886810302734 178.7577972412109 77.94724273681641 179.3027038574219 L 77.94242095947266 179.3049163818359 L 77.93760681152344 179.3071594238281 C 77.54368591308594 179.4902648925781 77.15450286865234 179.6637420654297 76.74781799316406 179.8374786376953 L 76.74211120605469 179.8398895263672 L 76.73639678955078 179.8423767089844 C 73.5361328125 181.2228698730469 70.17726898193359 182.2790069580078 66.75310516357422 182.9814453125 C 63.35699462890625 183.6781311035156 59.87488174438477 184.0314483642578 56.40446090698242 184.0314483642578 Z M 7.354867458343506 144.6830444335938 C 9.730923652648926 154.3983764648438 14.88522148132324 163.1176605224609 22.26079177856445 169.8984222412109 C 31.6140022277832 178.4915466308594 43.74073791503906 183.2235565185547 56.40795135498047 183.2235565185547 C 63.34200286865234 183.2235565185547 70.07834625244141 181.8369293212891 76.42984771728516 179.1021575927734 C 82.98921203613281 176.2706909179688 88.78671264648438 172.1356353759766 93.66429138183594 166.8105773925781 L 121.14013671875 136.7796630859375 L 121.1516571044922 136.7670593261719 L 121.1630783081055 136.7543182373047 L 121.373779296875 136.5194549560547 L 125.899787902832 131.5791778564453 L 128.2601623535156 129.0027618408203 L 125.6876831054688 126.6381072998047 L 114.9671325683594 116.7836303710938 L 114.7908172607422 116.6216812133789 L 56.36695098876953 62.90273666381836 L 53.78437042236328 60.52813339233398 L 51.41592407226562 63.11636734008789 L 19.17976570129395 98.34410858154297 C 16.68321228027344 101.0742645263672 14.48102855682373 104.0840530395508 12.63350200653076 107.2907867431641 L 12.63216018676758 107.2931060791016 L 12.63084411621094 107.2954254150391 C 12.31426525115967 107.8468704223633 12.00358104705811 108.4115524291992 11.70747566223145 108.9738159179688 C 10.03443336486816 112.1464385986328 8.697423934936523 115.5218505859375 7.734461784362793 119.0047302246094 C 7.59551477432251 119.4927062988281 7.456825256347656 120.0251617431641 7.298449516296387 120.6787872314453 C 6.89921236038208 122.3207550048828 6.581845760345459 124.0157012939453 6.355772018432617 125.7140579223633 C 6.262693405151367 126.3741302490234 6.183499813079834 127.0505905151367 6.120323657989502 127.7250823974609 C 5.96768045425415 129.2839965820312 5.890291690826416 130.9064483642578 5.890291690826416 132.5474243164062 C 5.890291690826416 133.1372833251953 5.900870800018311 133.7327575683594 5.92168664932251 134.3173370361328 C 5.93165397644043 134.5989532470703 5.941971778869629 134.8905639648438 5.96292781829834 135.2059326171875 C 5.975310325622559 135.5215606689453 5.996721267700195 135.8262786865234 6.015738964080811 136.0970764160156 C 6.05708122253418 136.6815032958984 6.109686374664307 137.2793884277344 6.172238826751709 137.8760528564453 L 6.17292308807373 137.8827362060547 L 6.173660278320312 137.8894195556641 C 6.232332229614258 138.4292449951172 6.286653518676758 138.8751678466797 6.343752384185791 139.2854766845703 C 6.358368396759033 139.4202575683594 6.374836444854736 139.5354309082031 6.38855504989624 139.6313629150391 L 6.391649723052979 139.6530609130859 C 6.445834159851074 140.0412292480469 6.505083084106445 140.4335174560547 6.567983150482178 140.8202056884766 C 6.577694416046143 140.8888854980469 6.5893874168396 140.9570617675781 6.603044986724854 141.0247497558594 C 6.671839237213135 141.4432678222656 6.739948272705078 141.8211364746094 6.810428619384766 142.1756744384766 C 6.894014358520508 142.6221466064453 6.977794170379639 143.03173828125 7.066226482391357 143.4263763427734 C 7.160753726959229 143.8706970214844 7.255234718322754 144.2820892333984 7.354867458343506 144.6830444335938 Z M 115.7378463745117 116.4084625244141 L 126.2139205932617 126.0419464111328 L 128.7975616455078 128.4177703857422 L 131.1660308837891 125.8274230957031 L 135.0262298583984 121.6056594848633 L 135.252685546875 121.3607406616211 L 135.2589263916016 121.3539733886719 L 135.26513671875 121.3471832275391 L 163.444580078125 90.54599761962891 C 172.0143737792969 81.18592071533203 176.7344818115234 69.03518676757812 176.7344818115234 56.33302688598633 C 176.7344818115234 49.38542175292969 175.3514556884766 42.63579177856445 172.6237945556641 36.2716064453125 C 169.7970581054688 29.68965911865234 165.6708221435547 23.8769474029541 160.3587188720703 18.9925537109375 C 155.2264709472656 14.26697444915771 149.3139190673828 10.72334289550781 142.7870788574219 8.461710929870605 C 141.7551727294922 8.104804992675781 140.7224273681641 7.783891677856445 139.7156372070312 7.507154941558838 C 137.9988708496094 7.030063152313232 136.2849273681641 6.648822784423828 134.6211395263672 6.373908042907715 C 131.8572845458984 5.908326625823975 129.0298767089844 5.672316551208496 126.2168426513672 5.672316551208496 C 119.2710571289062 5.672316551208496 112.5338973999023 7.059264183044434 106.1925277709961 9.794631958007812 C 99.63531494140625 12.61997413635254 93.83668518066406 16.75547409057617 88.95897674560547 22.08565902709961 L 56.67897415161133 57.36228942871094 L 54.32189559936523 59.93815994262695 L 56.89208221435547 62.30144882202148 L 115.5802917480469 116.2655563354492 L 115.5895309448242 116.274055480957 L 115.5988464355469 116.282470703125 L 115.7378463745117 116.4084625244141 Z" fill="currentColor"/>
                      </g>
                    </svg>
                  )}
                  {link.name === 'X' && (
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path>
                    </svg>
                  )}
                  {link.name === 'TikTok' && (
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinejoin="round">
                      <path d="M16.8217 5.1344C16.0886 4.29394 15.6479 3.19805 15.6479 2H14.7293M16.8217 5.1344C17.4898 5.90063 18.3944 6.45788 19.4245 6.67608C19.7446 6.74574 20.0786 6.78293 20.4266 6.78293V10.2191C18.645 10.2191 16.9932 9.64801 15.6477 8.68211V15.6707C15.6477 19.1627 12.8082 22 9.32386 22C7.50043 22 5.85334 21.2198 4.69806 19.98C3.64486 18.847 2.99994 17.3331 2.99994 15.6707C2.99994 12.2298 5.75592 9.42509 9.17073 9.35079M16.8217 5.1344C16.8039 5.12276 16.7861 5.11101 16.7684 5.09914M6.9855 17.3517C6.64217 16.8781 6.43802 16.2977 6.43802 15.6661C6.43802 14.0734 7.73249 12.7778 9.32394 12.7778C9.62087 12.7778 9.9085 12.8288 10.1776 12.9124V9.40192C9.89921 9.36473 9.61622 9.34149 9.32394 9.34149C9.27287 9.34149 8.86177 9.36884 8.81073 9.36884M14.7244 2H12.2097L12.2051 15.7775C12.1494 17.3192 10.8781 18.5591 9.32386 18.5591C8.35878 18.5591 7.50971 18.0808 6.98079 17.3564"/>
                    </svg>
                  )}
                  {link.name === 'Instagram' && (
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32" fill="currentColor">
                      <path d="M22.3,8.4c-0.8,0-1.4,0.6-1.4,1.4c0,0.8,0.6,1.4,1.4,1.4c0.8,0,1.4-0.6,1.4-1.4C23.7,9,23.1,8.4,22.3,8.4z"/>
                      <path d="M16,10.2c-3.3,0-5.9,2.7-5.9,5.9s2.7,5.9,5.9,5.9s5.9-2.7,5.9-5.9S19.3,10.2,16,10.2z M16,19.9c-2.1,0-3.8-1.7-3.8-3.8   c0-2.1,1.7-3.8,3.8-3.8c2.1,0,3.8,1.7,3.8,3.8C19.8,18.2,18.1,19.9,16,19.9z"/>
                      <path d="M20.8,4h-9.5C7.2,4,4,7.2,4,11.2v9.5c0,4,3.2,7.2,7.2,7.2h9.5c4,0,7.2-3.2,7.2-7.2v-9.5C28,7.2,24.8,4,20.8,4z M25.7,20.8   c0,2.7-2.2,5-5,5h-9.5c-2.7,0-5-2.2-5-5v-9.5c0-2.7,2.2-5,5-5h9.5c2.7,0,5,2.2,5,5V20.8z"/>
                    </svg>
                  )}
                </a>
              ))}
            </div>
          )}
          <div className="menu-footer-links">
            <button 
              className="menu-footer-link"
              onClick={() => toggle('terms')}
            >
              Terms of Use
            </button>
            <button 
              className="menu-footer-link"
              onClick={() => toggle('privacy')}
            >
              Privacy Policy
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}
